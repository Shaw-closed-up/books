<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="/static/img/favicon.png" rel="icon" type="image/png">

    <!-- Theme CSS -->
    <link href="https://freeaihub.oss-cn-beijing.aliyuncs.com/asset/css/theme.css" rel="stylesheet" type="text/css"/>
    <link href="https://freeaihub.oss-cn-beijing.aliyuncs.com/asset/css/style.css" rel="stylesheet" type="text/css"/>
    <title>Pandas 数据帧(DataFrame) - FreeAIHub</title>
  
    <style>
      #top_bar {
          /* background-color: #6e84a3;
          color: white;
          font: bold 12px Helvetica;
          padding: 6px 5px 4px 5px;
          border-bottom: 1px outset; */
      }
      #status {
          text-align: center;
      }
      #sendCtrlAltDelButton {
          position: fixed;
          top: 0px;
          right: 0px;
          border: 1px outset;
          padding: 5px 5px 4px 5px;
          cursor: pointer;
      }

      #screen {
          /* flex: 1;
          overflow: hidden; */
      }

  </style>

  </head>
  <body class="bg-light" style="padding-top: 84px;">
      <!-- NAVBAR
    ================================================== -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top bg-white border-bottom">
      <div class="container-fluid" style="height: 42px;">

        <!-- Brand -->
        <a class="navbar-brand" href="../index.html">

          <img src="https://freeaihub.oss-cn-beijing.aliyuncs.com/asset/images/freeaihub.svg" width="60%" alt="freeai logo">
        </a>

        <!-- Toggler -->
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Collapse -->
        <div class="collapse navbar-collapse" id="navbarCollapse">

          <!-- Toggler -->
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
            <i class="fe fe-x"></i>
          </button>

          <!-- Navigation -->
          <ul class="navbar-nav ml-auto">
         
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#banner">首页</a>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#banner">课程页面</a>
            </li>
            <li class="nav-item dropdown">
            
            </li>
          </ul>
        </div>

      </div>
    </nav>


    <!-- BREADCRUMB
    ================================================== -->
    <nav class="d-lg-none bg-gray-800">
      <div class="container-fluid">
        <div class="row align-items-center">
          <div class="col">
          </div>
          <div class="col-auto">
            <!-- Toggler -->
            <div class="navbar-dark">
              <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#sidenavCollapse" aria-controls="sidenavCollapse" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
              </button>
            </div>

          </div>
        </div> <!-- / .row -->
      </div> <!-- / .container -->
    </nav>

    <!-- CONTENT
    ================================================== -->
    <section style="overflow: hidden;">
      <div class="container-fluid">
        <div class="row">

          <div class="col-12 col-lg-2 col-xl-2 px-lg-0 border-bottom border-bottom-lg-0 border-right-lg border-gray-300 sidenav sidenav-left">     
            <div class="collapse d-lg-block" id="sidenavCollapse">
              <div class="px-lg-5">
                <ul class="nav side-left">
                  <li><a href="./index.html"> 如何学习本课程</a></li>
<li><a href="./intro.html"> Pandas简介</a></li>
<li><a href="./setup.html"> Pandas安装</a></li>
<li><a href="./data-structure.html"> Pandas数据结构</a></li>
<li><a href="./series.html"> Pandas序列</a></li>
<li><a href="./dataframe.html"> Pandas数据帧</a></li>
<li><a href="./basic.html"> Pandas基本功能</a></li>
<li><a href="./description.html"> Pandas描述性统计</a></li>
<li><a href="./apply.html"> Pandas函数应用</a></li>
<li><a href="./reindex.html"> Pandas索引重建</a></li>
<li><a href="./iteration.html"> Pandas迭代</a></li>
<li><a href="./sort.html"> Pandas排序</a></li>
<li><a href="./string-operation.html"> Pandas字符串和文本数据</a></li>
<li><a href="./option.html"> Pandas选项和自定义</a></li>
<li><a href="./loc.html"> Pandas索引和选择数据</a></li>
<li><a href="./statistics.html"> Pandas统计函数</a></li>
<li><a href="./aggreation.html"> Pandas聚合</a></li>
<li><a href="./groupby.html"> Pandas分组</a></li>
<li><a href="./merge-join.html"> Pandas合并与连接 </a></li>
<li><a href="./visualization.html"> Pandas可视化</a></li>
<li><a href="./categorical.html"> Pandas分类数据处理 </a></li>
<li><a href="./time-series.html"> Pandas时间序列</a></li>
<li><a href="./window.html"> Pandas窗口函数</a></li>
                </ul>  

              </div>
            </div>


          </div>

          <div class="entry-cellcontent col-10 col-lg-10 col-xl-10 offset-lg-2 offset-xl-2">
          <h1>Pandas 数据帧(DataFrame)</h1>
<p>数据帧(DataFrame)是二维数据结构，即数据以行和列的表格方式排列。</p>
<p>数据帧(DataFrame)的功能特点：</p>
<ul>
<li>潜在的列是不同的类型</li>
<li>大小可变</li>
<li>标记轴(行和列)</li>
<li>可以对行和列执行算术运算</li>
</ul>
<p><strong>结构体</strong></p>
<p>假设要创建一个包含学生数据的数据帧。参考以下图示 - </p>
<p><img alt="img" src="../images/dataframe.jpg" /></p>
<p>可以将上图表视为SQL表或电子表格数据表示。</p>
<h2>pandas.DataFrame</h2>
<p><em>pandas</em>中的<code>DataFrame</code>可以使用以下构造函数创建 -</p>
<pre><code>pandas.DataFrame( data, index, columns, dtype, copy)
</code></pre>

<p>构造函数的参数如下 -  </p>
<table>
<thead>
<tr>
<th>编号</th>
<th>参数</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><code>data</code></td>
<td>数据采取各种形式，如:<code>ndarray</code>，<code>series</code>，<code>map</code>，<code>lists</code>，<code>dict</code>，<code>constant</code>和另一个<code>DataFrame</code>。</td>
</tr>
<tr>
<td>2</td>
<td><code>index</code></td>
<td>对于行标签，要用于结果帧的索引是可选缺省值<code>np.arrange(n)</code>，如果没有传递索引值。</td>
</tr>
<tr>
<td>3</td>
<td><code>columns</code></td>
<td>对于列标签，可选的默认语法是 - <code>np.arange(n)</code>。 这只有在没有索引传递的情况下才是这样。</td>
</tr>
<tr>
<td>4</td>
<td><code>dtype</code></td>
<td>每列的数据类型。</td>
</tr>
<tr>
<td>5</td>
<td><code>copy</code></td>
<td>如果默认值为<code>False</code>，则此命令(或任何它)用于复制数据。</td>
</tr>
</tbody>
</table>
<h2>创建DataFrame</h2>
<p>Pandas数据帧(<em>DataFrame</em>)可以使用各种输入创建，如 - </p>
<ul>
<li>列表</li>
<li>字典</li>
<li>系列</li>
<li>Numpy ndarrays</li>
<li>另一个数据帧(<em>DataFrame</em>)</li>
</ul>
<p>在本章的后续章节中，我们将看到如何使用这些输入创建数据帧(<em>DataFrame</em>)。</p>
<h2>创建一个空的DataFrame</h2>
<p>创建基本数据帧是空数据帧。
<strong>示例</strong></p>
<pre><code class="python">#import the pandas library and aliasing as pd
import pandas as pd
df = pd.DataFrame()
df
</code></pre>

<h2>从列表创建DataFrame</h2>
<p>可以使用单个列表或列表列表创建数据帧(<em>DataFrame</em>)。</p>
<p><strong>实例-1</strong></p>
<pre><code class="python">import pandas as pd
data = [1,2,3,4,5]
df = pd.DataFrame(data)
df
</code></pre>

<p><strong>实例-2</strong></p>
<pre><code class="python">import pandas as pd
data = [['Alex',10],['Bob',12],['Clarke',13]]
df = pd.DataFrame(data,columns=['Name','Age'])
df
</code></pre>

<p><strong>实例-3</strong></p>
<pre><code class="python">import pandas as pd
data = [['Alex',10],['Bob',12],['Clarke',13]]
df = pd.DataFrame(data,columns=['Name','Age'],dtype=float)
df
</code></pre>

<blockquote>
<p>注意 - 可以观察到，<code>dtype</code>参数将<code>Age</code>列的类型更改为浮点。</p>
</blockquote>
<h2>从ndarrays/Lists的字典来创建DataFrame</h2>
<p>所有的<code>ndarrays</code>必须具有相同的长度。如果传递了索引(<code>index</code>)，则索引的长度应等于数组的长度。</p>
<p>如果没有传递索引，则默认情况下，索引将为<code>range(n)</code>，其中<code>n</code>为数组长度。</p>
<p><strong>实例-1</strong></p>
<pre><code class="python">import pandas as pd
data = {'Name':['Tom', 'Jack', 'Steve', 'Ricky'],'Age':[28,34,29,42]}
df = pd.DataFrame(data)
df
</code></pre>

<blockquote>
<p>注 - 观察值<code>0</code>,<code>1</code>,<code>2</code>,<code>3</code>。它们是分配给每个使用函数<code>range(n)</code>的默认索引。</p>
</blockquote>
<p><strong>示例-2</strong></p>
<p>使用数组创建一个索引的数据帧(<em>DataFrame</em>)。</p>
<pre><code class="python">import pandas as pd
data = {'Name':['Tom', 'Jack', 'Steve', 'Ricky'],'Age':[28,34,29,42]}
df = pd.DataFrame(data, index=['rank1','rank2','rank3','rank4'])
df
</code></pre>

<blockquote>
<p>注意 - <code>index</code>参数为每行分配一个索引。</p>
</blockquote>
<h2>从列表创建数据帧DataFrame</h2>
<p>字典列表可作为输入数据传递以用来创建数据帧(<em>DataFrame</em>)，字典键默认为列名。</p>
<p><strong>实例-1</strong></p>
<p>以下示例显示如何通过传递字典列表来创建数据帧(<em>DataFrame</em>)。</p>
<pre><code class="python">import pandas as pd
data = [{'a': 1, 'b': 2},{'a': 5, 'b': 10, 'c': 20}]
df = pd.DataFrame(data)
df
</code></pre>

<blockquote>
<p>注意 - 观察到，NaN(不是数字)被附加在缺失的区域。</p>
</blockquote>
<p><strong>示例-2</strong></p>
<p>以下示例显示如何通过传递字典列表和行索引来创建数据帧(<em>DataFrame</em>)。</p>
<pre><code class="python">import pandas as pd
data = [{'a': 1, 'b': 2},{'a': 5, 'b': 10, 'c': 20}]
df = pd.DataFrame(data, index=['first', 'second'])
df
</code></pre>

<p><strong>实例-3</strong></p>
<p>以下示例显示如何使用字典，行索引和列索引列表创建数据帧(<em>DataFrame</em>)。</p>
<pre><code class="python">import pandas as pd
data = [{'a': 1, 'b': 2},{'a': 5, 'b': 10, 'c': 20}]

#With two column indices, values same as dictionary keys
df1 = pd.DataFrame(data, index=['first', 'second'], columns=['a', 'b'])

#With two column indices with one index with other name
df2 = pd.DataFrame(data, index=['first', 'second'], columns=['a', 'b1'])

print(df1)
print(df2)
</code></pre>

<blockquote>
<p>注意 - 观察，<code>df2</code>使用字典键以外的列索引创建<code>DataFrame</code>; 因此，附加了NaN到位置上。 而<code>df1</code>是使用列索引创建的，与字典键相同，所以也附加了NaN。</p>
</blockquote>
<h2>从系列的字典来创建DataFrame</h2>
<p>字典的系列可以传递以形成一个DataFrame。 所得到的索引是通过的所有系列索引的并集。</p>
<p><strong>示例</strong></p>
<pre><code class="python">import pandas as pd

d = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']),
      'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])}

df = pd.DataFrame(d)
df
</code></pre>

<blockquote>
<p>注意 - 对于第一个系列，观察到没有传递标签<code>'d'</code>，但在结果中，对于<code>d</code>标签，附加了NaN。</p>
</blockquote>
<p>现在通过实例来了解列选择，添加和删除。</p>
<h3>列选择</h3>
<p>下面将通过从数据帧(DataFrame)中选择一列。</p>
<p>示例</p>
<pre><code class="python">import pandas as pd

d = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']),
      'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])}

df = pd.DataFrame(d)
df['one']
</code></pre>

<h3>列添加</h3>
<p>下面将通过向现有数据框添加一个新列来理解这一点。</p>
<p><strong>示例</strong></p>
<pre><code class="python">import pandas as pd

d = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']),
      'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])}

df = pd.DataFrame(d)

# Adding a new column to an existing DataFrame object with column label by passing new series

print(&quot;Adding a new column by passing as Series:&quot;)
df['three']=pd.Series([10,20,30],index=['a','b','c'])
print(df)

print(&quot;Adding a new column using the existing columns in DataFrame:&quot;)
df['four']=df['one']+df['three']
print(df)
</code></pre>

<h3>列删除</h3>
<p>列可以删除或弹出; 看看下面的例子来了解一下。</p>
<p><strong>例子</strong></p>
<pre><code class="python"># Using the previous DataFrame, we will delete a column
# using del function
import pandas as pd

d = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']), 
     'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd']), 
     'three' : pd.Series([10,20,30], index=['a','b','c'])}

df = pd.DataFrame(d)
print(&quot;Our dataframe is:&quot;)
print(df)

# using del function
print(&quot;Deleting the first column using DEL function:&quot;)
del df['one']
print(df)

# using pop function
print(&quot;Deleting another column using POP function:&quot;)
df.pop('two')
print(df)
</code></pre>

<h2>行选择，添加和删除</h2>
<p>现在将通过下面实例来了解行选择，添加和删除。我们从选择的概念开始。</p>
<p><strong>标签选择</strong></p>
<p>可以通过将行标签传递给<code>loc()</code>函数来选择行。参考以下示例代码 - </p>
<pre><code class="python">import pandas as pd

d = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']), 
     'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])}

df = pd.DataFrame(d)
print(df.loc['b'])
</code></pre>

<p>结果是一系列标签作为<code>DataFrame</code>的列名称。 而且，系列的名称是检索的标签。</p>
<p><strong>按整数位置选择</strong></p>
<p>可以通过将整数位置传递给<code>iloc()</code>函数来选择行。参考以下示例代码 - </p>
<pre><code class="python">import pandas as pd

d = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']),
     'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])}

df = pd.DataFrame(d)
print(df.iloc[2])
</code></pre>

<h2>行切片</h2>
<p>可以使用<code>:</code>运算符选择多行。参考以下示例代码 - </p>
<pre><code class="python">import pandas as pd

d = {'one' : pd.Series([1, 2, 3], index=['a', 'b', 'c']), 
    'two' : pd.Series([1, 2, 3, 4], index=['a', 'b', 'c', 'd'])}

df = pd.DataFrame(d)
print(df[2:4])
</code></pre>

<p><strong>附加行</strong></p>
<p>使用<code>append()</code>函数将新行添加到DataFrame。 此功能将附加行结束。</p>
<pre><code class="python">import pandas as pd

df = pd.DataFrame([[1, 2], [3, 4]], columns = ['a','b'])
df2 = pd.DataFrame([[5, 6], [7, 8]], columns = ['a','b'])

df = df.append(df2)
print(df[2:4])
</code></pre>

<p><strong>删除行</strong></p>
<p>使用索引标签从DataFrame中删除或删除行。 如果标签重复，则会删除多行。</p>
<p>如果有注意，在上述示例中，有标签是重复的。这里再多放一个标签，看看有多少行被删除。</p>
<pre><code class="python">import pandas as pd

df = pd.DataFrame([[1, 2], [3, 4]], columns = ['a','b'])
df2 = pd.DataFrame([[5, 6], [7, 8]], columns = ['a','b'])

print(df)
print(df2)

import pandas as pd

df = pd.DataFrame([[1, 2], [3, 4]], columns = ['a','b'])
df2 = pd.DataFrame([[5, 6], [7, 8]], columns = ['a','b'])

df = df.append(df2)

# Drop rows with label 0
df = df.drop(0)

print(df[2:4])
</code></pre>

<p>在上面的例子中，一共有两行被删除，因为这两行包含相同的标签<code>0</code>。</p>
          </div>
          <backend type="k"></backend>
          <code class=gatsby-kernelname data-language=python></code>
        </div> <!-- / .row -->
      </div>
      
    </section>

    <!-- JAVASCRIPT
    ================================================== -->
    <!-- Libs JS -->
    <script src="https://landkit.goodthemes.co/assets/libs/jquery/dist/jquery.min.js"></script>
    <script src="https://landkit.goodthemes.co/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Theme JS -->
    <script src="https://landkit.goodthemes.co/assets/js/theme.min.js"></script>
    <script src="https://cdn.freeaihub.com/asset/js/cell.js"></script>
          
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script>
    MathJax = {
      tex: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
    };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  </body>
</html>