<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="/static/img/favicon.png" rel="icon" type="image/png">

    <!-- Theme CSS -->
    <link href="https://freeaihub.oss-cn-beijing.aliyuncs.com/asset/css/theme.css" rel="stylesheet" type="text/css"/>
    <link href="https://freeaihub.oss-cn-beijing.aliyuncs.com/asset/css/style.css" rel="stylesheet" type="text/css"/>
    <title>sklearn Kè¿‘é‚»(KNN) - FreeAIHub</title>
  
    <style>
      #top_bar {
          /* background-color: #6e84a3;
          color: white;
          font: bold 12px Helvetica;
          padding: 6px 5px 4px 5px;
          border-bottom: 1px outset; */
      }
      #status {
          text-align: center;
      }
      #sendCtrlAltDelButton {
          position: fixed;
          top: 0px;
          right: 0px;
          border: 1px outset;
          padding: 5px 5px 4px 5px;
          cursor: pointer;
      }

      #screen {
          /* flex: 1;
          overflow: hidden; */
      }

  </style>

  </head>
  <body class="bg-light" style="padding-top: 84px;">
      <header class="navbar navbar-expand navbar-dark flex-column flex-md-row bd-navbar text-center">
      <a class="navbar-brand mr-0 mr-md-2" aria-label="å¼•å¯¼ç¨‹åº" href="/">
        <img src="https://freeaihub.oss-cn-beijing.aliyuncs.com/asset/images/freeaihub.svg" width="60%" alt="freeai logo">
      </a>
      <ul class="navbar-nav ml-md-auto">
        <li class="nav-item">
          <a href="/" class="nav-link pl-2 pr-1 mx-1 py-3 my-n2">é¦–é¡µ</a>
        </li>
        <li class="nav-item">
          <a href="/" class="nav-link pl-2 pr-1 mx-1 py-3 my-n2">è¯¾ç¨‹é¡µé¢</a>
        </li>
      </ul>
    </header>



    <!-- BREADCRUMB
    ================================================== -->
    <nav class="d-lg-none bg-gray-800">
      <div class="container-fluid">
        <div class="row align-items-center">
          <div class="col">
          </div>
          <div class="col-auto">
            <!-- Toggler -->
            <div class="navbar-dark">
              <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#sidenavCollapse" aria-controls="sidenavCollapse" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
              </button>
            </div>

          </div>
        </div> <!-- / .row -->
      </div> <!-- / .container -->
    </nav>

    <!-- CONTENT
    ================================================== -->
    <section style="overflow: hidden;">
      <div class="container-fluid">
        <div class="row">

          <div class="col-12 col-lg-2 col-xl-2 px-lg-0 border-bottom border-bottom-lg-0 border-right-lg border-gray-300 sidenav sidenav-left">     
            <div class="collapse d-lg-block" id="sidenavCollapse">
              <div class="px-lg-5">
                <ul class="nav side-left">
                  <li><a href="./index.html"> å¦‚ä½•å­¦ä¹ æœ¬è¯¾ç¨‹</a></li>
<li><a href="./intro.html"> sklearnç®€ä»‹</a></li>
<li><a href="./setup.html"> sklearnå®‰è£…</a></li>
<li><a href="./modelling.html"> sklearnå»ºæ¨¡è¿‡ç¨‹</a></li>
<li><a href="./data-representation.html"> sklearnæ•°æ®è¡¨ç¤º</a></li>
<li><a href="./estimator.html"> sklearnä¼°ç®—å™¨</a></li>
<li><a href="./conventions.html"> sklearnçº¦å®š</a></li>
<li><a href="./linear.html"> sklearnçº¿æ€§å»ºæ¨¡ä¹‹çº¿æ€§å›å½’</a></li>
<li><a href="./logistic.html"> sklearnçº¿æ€§å»ºæ¨¡ä¹‹é€»è¾‘å›å½’</a></li>
<li><a href="./ridge.html"> sklearnçº¿æ€§å»ºæ¨¡ä¹‹å²­å›å½’</a></li>
<li><a href="./bayes.html"> sklearnçº¿æ€§å»ºæ¨¡ä¹‹è´å¶æ–¯å²­å›å½’</a></li>
<li><a href="./sgd.html"> sklearnéšæœºæ¢¯åº¦ä¸‹é™(SGD)</a></li>
<li><a href="./svm.html"> sklearnæ”¯æŒå‘é‡æœº(SVM)</a></li>
<li><a href="./knn.html"> sklearnKè¿‘é‚»(KNN)</a></li>
<li><a href="./nbc.html"> sklearnæœ´ç´ è´å¶æ–¯åˆ†ç±»(NBC)</a></li>
<li><a href="./dt.html"> sklearnå†³ç­–æ ‘(DT)</a></li>
<li><a href="./rf.html"> sklearnéšæœºå†³ç­–æ ‘(RF)</a></li>
<li><a href="./cluster.html"> skelarnèšç±»(cluster)</a></li>
<li><a href="./pca.html"> sklearné™ç»´(PCA)</a></li>
                </ul>  

              </div>
            </div>


          </div>

          <div class="entry-cellcontent col-10 col-lg-10 col-xl-10 offset-lg-2 offset-xl-2">
          <h1>sklearn Kè¿‘é‚»(KNN)</h1>
<p>æœ¬ç« å°†å¸®åŠ©æ‚¨äº†è§£Sklearnä¸­æœ€æ¥è¿‘çš„é‚»å±…æ–¹æ³•ã€‚</p>
<p>åŸºäºé‚»å±…çš„å­¦ä¹ æ–¹æ³•æœ‰ä¸¤ç§ç±»å‹ï¼Œå³æœ‰<strong>ç›‘ç£çš„</strong>å’Œ<strong>æ— ç›‘ç£çš„ã€‚</strong>åŸºäºç›‘ç£çš„åŸºäºé‚»å±…çš„å­¦ä¹ æ—¢å¯ä»¥ç”¨äºåˆ†ç±»é¢„æµ‹é—®é¢˜ï¼Œä¹Ÿå¯ä»¥ç”¨äºå›å½’é¢„æµ‹é—®é¢˜ï¼Œä½†æ˜¯å®ƒä¸»è¦ç”¨äºè¡Œä¸šä¸­çš„åˆ†ç±»é¢„æµ‹é—®é¢˜ã€‚</p>
<p>åŸºäºé‚»å±…çš„å­¦ä¹ æ–¹æ³•æ²¡æœ‰ä¸“é—¨çš„è®­ç»ƒé˜¶æ®µï¼Œè€Œæ˜¯åœ¨åˆ†ç±»æ—¶å°†æ‰€æœ‰æ•°æ®ç”¨äºè®­ç»ƒã€‚å®ƒè¿˜ä¸å‡å®šæœ‰å…³åŸºç¡€æ•°æ®çš„ä»»ä½•ä¿¡æ¯ã€‚è¿™å°±æ˜¯å®ƒä»¬æœ¬è´¨ä¸Šæ˜¯æƒ°æ€§å’Œéå‚æ•°åŒ–çš„åŸå› ã€‚</p>
<p>æœ€è¿‘é‚»å±…æ–¹æ³•èƒŒåçš„ä¸»è¦åŸç†æ˜¯-</p>
<ul>
<li>æŸ¥æ‰¾è·ç¦»æ–°æ•°æ®ç‚¹æœ€è¿‘çš„å£æ©±ä¸­é¢„å®šæ•°é‡çš„è®­ç»ƒæ ·æœ¬</li>
<li>ä»è¿™äº›æ•°é‡çš„è®­ç»ƒæ ·æœ¬ä¸­é¢„æµ‹æ ‡ç­¾ã€‚</li>
</ul>
<p>åœ¨è¿™é‡Œï¼Œæ ·æœ¬æ•°å¯ä»¥æ˜¯ç”¨æˆ·å®šä¹‰çš„å¸¸æ•°ï¼Œä¾‹å¦‚åœ¨Kè¿‘é‚»å­¦ä¹ ä¸­ï¼Œä¹Ÿå¯ä»¥æ ¹æ®ç‚¹çš„å±€éƒ¨å¯†åº¦è€Œå˜åŒ–ï¼Œä¾‹å¦‚åœ¨åŸºäºåŠå¾„çš„é‚»å±…å­¦ä¹ ä¸­ã€‚</p>
<h3>sklearn.neighborsæ¨¡å—</h3>
<p>Scikit-learnå…·æœ‰<strong>sklearn.neighbors</strong>æ¨¡å—ï¼Œè¯¥æ¨¡å—ä¸ºæ— ç›‘ç£å’Œå—ç›‘ç£çš„åŸºäºé‚»å±…çš„å­¦ä¹ æ–¹æ³•æä¾›åŠŸèƒ½ã€‚ä½œä¸ºè¾“å…¥ï¼Œæ­¤æ¨¡å—ä¸­çš„ç±»å¯ä»¥å¤„ç†NumPyæ•°ç»„æˆ–<strong>scipy.sparse</strong>çŸ©é˜µã€‚</p>
<h2>ç®—æ³•ç±»å‹</h2>
<p>å¯ä»¥åœ¨åŸºäºé‚»å±…çš„æ–¹æ³•çš„å®ç°ä¸­ä½¿ç”¨çš„ä¸åŒç±»å‹çš„ç®—æ³•å¦‚ä¸‹-</p>
<h3>è›®åŠ›</h3>
<p>æ•°æ®é›†ä¸­æ‰€æœ‰ç‚¹å¯¹ä¹‹é—´è·ç¦»çš„å¼ºåŠ›è®¡ç®—æä¾›äº†æœ€å¹¼ç¨šçš„é‚»å±…æœç´¢å®ç°ã€‚ä»æ•°å­¦ä¸Šæ¥è¯´ï¼Œå¯¹äºDä¸ªç»´åº¦ä¸Šçš„Nä¸ªæ ·æœ¬ï¼Œè›®åŠ›æ–¹æ³•çš„ç¼©æ”¾æ¯”ä¾‹ä¸º<strong>*0 [DN 2 ]*</strong></p>
<p>å¯¹äºå°æ•°æ®æ ·æœ¬ï¼Œæ­¤ç®—æ³•å¯èƒ½éå¸¸æœ‰ç”¨ï¼Œä½†æ˜¯éšç€æ ·æœ¬æ•°é‡çš„å¢åŠ ï¼Œå®ƒå˜å¾—ä¸å¯è¡Œã€‚å¯ä»¥é€šè¿‡ç¼–å†™å…³é”®å­—<strong>algorithm ='brute'</strong>æ¥å¯ç”¨è›®åŠ›é‚»å±…æœç´¢ã€‚</p>
<h3>KDæ ‘</h3>
<p>ä¸ºäº†è§£å†³æš´åŠ›ç ´è§£æ–¹æ³•çš„è®¡ç®—æ•ˆç‡ä½ä¸‹è€Œå‘æ˜çš„åŸºäºæ ‘çš„æ•°æ®ç»“æ„ä¹‹ä¸€å°±æ˜¯KDæ ‘æ•°æ®ç»“æ„ã€‚åŸºæœ¬ä¸Šï¼ŒKDæ ‘æ˜¯ä¸€ç§äºŒå‰æ ‘ç»“æ„ï¼Œç§°ä¸ºKç»´æ ‘ã€‚å®ƒé€šè¿‡å°†å‚æ•°ç©ºé—´åˆ’åˆ†ä¸ºåµŒå¥—çš„æ­£äº¤åŒºåŸŸæ¥å¡«å……æ•°æ®ç‚¹ï¼Œä»è€Œæ²¿æ•°æ®è½´é€’å½’åˆ’åˆ†å‚æ•°ç©ºé—´ã€‚</p>
<h3>ä¼˜ç‚¹</h3>
<p>ä»¥ä¸‹æ˜¯KDæ ‘ç®—æ³•çš„ä¸€äº›ä¼˜ç‚¹-</p>
<p><strong>æ„é€ é€Ÿåº¦å¿«</strong> -ç”±äºä»…æ²¿æ•°æ®è½´æ‰§è¡Œåˆ†åŒºï¼Œå› æ­¤KDæ ‘çš„æ„é€ é€Ÿåº¦éå¸¸å¿«ã€‚</p>
<p><strong>æ›´å°‘çš„è·ç¦»è®¡ç®—</strong> -è¯¥ç®—æ³•åªéœ€å¾ˆå°‘çš„è·ç¦»è®¡ç®—å³å¯ç¡®å®šæŸ¥è¯¢ç‚¹çš„æœ€è¿‘é‚»å±…ã€‚å®ƒåªéœ€è¦<strong>ğ‘¶[ğ¥ğ¨ğ ï¼ˆğ‘µï¼‰]ä¸ª</strong>è·ç¦»è®¡ç®—ã€‚</p>
<h3>ç¼ºç‚¹</h3>
<p><strong>ä»…å¯¹ä½ç»´é‚»å±…æœç´¢</strong>å¿«é€Ÿ-å¯¹ä½ç»´ï¼ˆD &lt;20ï¼‰é‚»å±…æœç´¢éå¸¸å¿«ï¼Œä½†æ˜¯éšç€Dçš„å¢é•¿ï¼Œå®ƒå˜å¾—æ— æ•ˆã€‚ç”±äºä»…æ²¿æ•°æ®è½´æ‰§è¡Œåˆ†åŒºï¼Œ</p>
<p>å¯ä»¥é€šè¿‡ç¼–å†™å…³é”®å­—<strong>algorithm ='kd_tree'</strong>æ¥å¯ç”¨KDæ ‘é‚»å±…æœç´¢ã€‚</p>
<h3>çƒæ ‘</h3>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒKDæ ‘åœ¨é«˜ç»´æ–¹é¢æ•ˆç‡ä½ä¸‹ï¼Œå› æ­¤ï¼Œä¸ºäº†è§£å†³KDæ ‘çš„è¿™ç§ä½æ•ˆç‡é—®é¢˜ï¼Œå¼€å‘äº†çƒæ ‘æ•°æ®ç»“æ„ã€‚åœ¨æ•°å­¦ä¸Šï¼Œå®ƒå°†æ•°æ®é€’å½’åœ°åˆ†ä¸ºè´¨å¿ƒCå’ŒåŠå¾„rå®šä¹‰çš„èŠ‚ç‚¹ï¼Œä»¥ä½¿èŠ‚ç‚¹ä¸­çš„æ¯ä¸ªç‚¹éƒ½ä½äºè´¨å¿ƒ<strong>C</strong>å’ŒåŠå¾„<strong>r</strong>å®šä¹‰çš„è¶…çƒé¢å†…ã€‚å®ƒä½¿ç”¨ä¸‹é¢ç»™å‡ºçš„ä¸‰è§’å½¢ä¸ç­‰å¼ï¼Œä»è€Œå‡å°‘äº†é‚»å±…æœç´¢çš„å€™é€‰ç‚¹æ•°</p>
<p>$$
\arrowvert X+Y\arrowvert\leq \arrowvert X\arrowvert+\arrowvert Y\arrowvert
$$</p>
<h3>ä¼˜ç‚¹</h3>
<p>ä»¥ä¸‹æ˜¯Ball Treeç®—æ³•çš„ä¸€äº›ä¼˜ç‚¹-</p>
<p><strong>é«˜æ•ˆå¤„ç†é«˜åº¦ç»“æ„åŒ–çš„æ•°æ®</strong> -ç”±äºçƒå½¢æ ‘å°†æ•°æ®åˆ’åˆ†ä¸ºä¸€ç³»åˆ—åµŒå¥—çš„è¶…çƒä½“ï¼Œå› æ­¤å¯¹é«˜æ•ˆå¤„ç†é«˜åº¦ç»“æ„åŒ–çš„æ•°æ®éå¸¸æœ‰æ•ˆã€‚</p>
<p><strong>è¡¨ç°ä¼˜äºKDæ ‘</strong> -çƒæ ‘åœ¨é«˜ç»´æ–¹é¢è¡¨ç°ä¼˜äºKDæ ‘ï¼Œå› ä¸ºå®ƒå…·æœ‰çƒæ ‘èŠ‚ç‚¹çš„çƒå½¢å‡ ä½•å½¢çŠ¶ã€‚</p>
<h3>ç¼ºç‚¹</h3>
<p>æˆæœ¬<strong>é«˜æ˜‚</strong> -å°†æ•°æ®åˆ’åˆ†ä¸ºä¸€ç³»åˆ—åµŒå¥—çš„è¶…çƒä½“ï¼Œä½¿å…¶æ„å»ºæˆæœ¬å¾ˆé«˜ã€‚</p>
<p>å¯ä»¥é€šè¿‡ç¼–å†™å…³é”®å­—<strong>algorithm ='ball_tree'</strong>æ¥å¯ç”¨çƒæ ‘é‚»å±…æœç´¢ã€‚</p>
<h2>é€‰æ‹©æœ€è¿‘é‚»å±…ç®—æ³•</h2>
<p>ç»™å®šæ•°æ®é›†çš„æœ€ä½³ç®—æ³•çš„é€‰æ‹©å–å†³äºä»¥ä¸‹å› ç´ -</p>
<h3>æ ·æœ¬æ•°ï¼ˆNï¼‰å’Œç»´æ•°ï¼ˆDï¼‰</h3>
<p>è¿™äº›æ˜¯é€‰æ‹©æœ€è¿‘é‚»å±…ç®—æ³•æ—¶è¦è€ƒè™‘çš„æœ€é‡è¦å› ç´ ã€‚è¿™æ˜¯ç”±äºä»¥ä¸‹åŸå› -</p>
<ul>
<li>è›®åŠ›ç®—æ³•çš„æŸ¥è¯¢æ—¶é—´éšç€O [DN]çš„å¢é•¿è€Œå¢åŠ ã€‚</li>
<li>çƒæ ‘ç®—æ³•çš„æŸ¥è¯¢æ—¶é—´éšç€O [D logï¼ˆNï¼‰]è€Œå¢é•¿ã€‚</li>
<li>KDæ ‘ç®—æ³•çš„æŸ¥è¯¢æ—¶é—´éšDçš„å˜åŒ–è€Œå˜åŒ–ï¼Œè¿™å¾ˆéš¾æè¿°ã€‚å½“D &lt;20æ—¶ï¼Œæˆæœ¬ä¸ºO [D logï¼ˆNï¼‰]ï¼Œè¯¥ç®—æ³•éå¸¸æœ‰æ•ˆã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨D&gt; 20çš„æƒ…å†µä¸‹æ•ˆç‡ä½ä¸‹ï¼Œå› ä¸ºæˆæœ¬å¢åŠ åˆ°æ¥è¿‘O [DN]ã€‚</li>
</ul>
<h3>æ•°æ®ç»“æ„</h3>
<p>å½±å“è¿™äº›ç®—æ³•æ€§èƒ½çš„å¦ä¸€ä¸ªå› ç´ æ˜¯æ•°æ®çš„å›ºæœ‰ç»´æ•°æˆ–æ•°æ®çš„ç¨€ç–æ€§ã€‚è¿™æ˜¯å› ä¸ºçƒæ ‘å’ŒKDæ ‘ç®—æ³•çš„æŸ¥è¯¢æ—¶é—´ä¼šå—åˆ°å¾ˆå¤§çš„å½±å“ã€‚è€Œè›®åŠ›ç®—æ³•çš„æŸ¥è¯¢æ—¶é—´åœ¨æ•°æ®ç»“æ„ä¸Šæ˜¯ä¸å˜çš„ã€‚é€šå¸¸ï¼Œå½“æ¤å…¥å…·æœ‰è¾ƒå°å›ºæœ‰ç»´æ•°çš„ç¨€ç–æ•°æ®æ—¶ï¼Œçƒæ ‘å’ŒKDæ ‘ç®—æ³•ä¼šäº§ç”Ÿæ›´å¿«çš„æŸ¥è¯¢æ—¶é—´ã€‚</p>
<h3>é‚»å±…æ•°ï¼ˆkï¼‰</h3>
<p>è¯·æ±‚ä¸€ä¸ªæŸ¥è¯¢ç‚¹çš„é‚»å±…æ•°ï¼ˆkï¼‰å½±å“çƒæ ‘å’ŒKDæ ‘ç®—æ³•çš„æŸ¥è¯¢æ—¶é—´ã€‚éšç€é‚»å±…æ•°ï¼ˆkï¼‰çš„å¢åŠ ï¼ŒæŸ¥è¯¢æ—¶é—´å˜æ…¢ã€‚è€Œè›®åŠ›çš„æŸ¥è¯¢æ—¶é—´å°†ä¸å—kå€¼çš„å½±å“ã€‚</p>
<h3>æŸ¥è¯¢ç‚¹æ•°</h3>
<p>å› ä¸ºå®ƒä»¬éœ€è¦æ„é€ é˜¶æ®µï¼Œæ‰€ä»¥å¦‚æœå­˜åœ¨å¤§é‡æŸ¥è¯¢ç‚¹ï¼Œåˆ™KDæ ‘ç®—æ³•å’ŒBallæ ‘ç®—æ³•éƒ½å°†æœ‰æ•ˆã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœæŸ¥è¯¢ç‚¹æ•°é‡è¾ƒå°‘ï¼Œåˆ™è›®åŠ›ç®—æ³•çš„æ€§èƒ½è¦ä¼˜äºKDæ ‘å’ŒBallæ ‘ç®—æ³•ã€‚</p>
<h2>KNNå®ç°</h2>
<p>k-NNï¼ˆkæœ€è¿‘é‚»ï¼‰æ˜¯æœ€ç®€å•çš„æœºå™¨å­¦ä¹ ç®—æ³•ä¹‹ä¸€ï¼Œæœ¬è´¨ä¸Šæ˜¯éå‚æ•°çš„å’Œæƒ°æ€§çš„ã€‚éå‚æ•°æ„å‘³ç€æ²¡æœ‰åŸºç¡€æ•°æ®åˆ†å¸ƒçš„å‡è®¾ï¼Œå³ä»æ•°æ®é›†ä¸­ç¡®å®šäº†æ¨¡å‹ç»“æ„ã€‚æ‡’æƒ°æˆ–åŸºäºå®ä¾‹çš„å­¦ä¹ æ„å‘³ç€ï¼Œå‡ºäºæ¨¡å‹ç”Ÿæˆçš„ç›®çš„ï¼Œå®ƒä¸éœ€è¦ä»»ä½•è®­ç»ƒæ•°æ®ç‚¹ï¼Œå¹¶ä¸”åœ¨æµ‹è¯•é˜¶æ®µå°†ä½¿ç”¨æ•´ä¸ªè®­ç»ƒæ•°æ®ã€‚</p>
<p>k-NNç®—æ³•åŒ…æ‹¬ä»¥ä¸‹ä¸¤ä¸ªæ­¥éª¤-</p>
<h3>æ­¥éª¤1</h3>
<p>åœ¨æ­¤æ­¥éª¤ä¸­ï¼Œå®ƒè®¡ç®—å¹¶å­˜å‚¨è®­ç»ƒé›†ä¸­æ¯ä¸ªæ ·æœ¬çš„kä¸ªæœ€è¿‘é‚»å±…ã€‚</p>
<h3>ç¬¬2æ­¥</h3>
<p>åœ¨æ­¤æ­¥éª¤ä¸­ï¼Œå¯¹äºæœªæ ‡è®°çš„æ ·æœ¬ï¼Œå®ƒå°†ä»æ•°æ®é›†ä¸­æ£€ç´¢kä¸ªæœ€è¿‘çš„é‚»å±…ã€‚ç„¶åï¼Œåœ¨è¿™äº›kè¿‘é‚»ä¸­ï¼Œå®ƒé€šè¿‡æŠ•ç¥¨æ¥é¢„æµ‹ç­çº§ï¼ˆå¤šæ•°ç¥¨çš„ç­çº§è·èƒœï¼‰ã€‚</p>
<p>å®ç°kè¿‘é‚»ç®—æ³•çš„æ¨¡å—<strong>sklearn.neighbors</strong>æä¾›äº†<strong>æ— ç›‘ç£</strong>ä»¥åŠåŸºäº<strong>ç›‘ç£</strong>çš„åŸºäºé‚»å±…çš„å­¦ä¹ æ–¹æ³•çš„åŠŸèƒ½ã€‚</p>
<p>æ— ç›‘ç£çš„æœ€è¿‘é‚»å±…å®æ–½ä¸åŒçš„ç®—æ³•ï¼ˆBallTreeï¼ŒKDTreeæˆ–è›®åŠ›ï¼‰ä»¥æ‰¾åˆ°æ¯ä¸ªæ ·æœ¬çš„æœ€è¿‘é‚»å±…ã€‚æ­¤æ— ç›‘ç£ç‰ˆæœ¬åŸºæœ¬ä¸Šåªæ˜¯ä¸Šé¢è®¨è®ºçš„ç¬¬ä¸€æ­¥ï¼Œå¹¶ä¸”æ˜¯éœ€è¦é‚»å±…æœç´¢çš„è®¸å¤šç®—æ³•ï¼ˆKNNå’ŒK-meansæ˜¯è‘—åçš„ç®—æ³•ï¼‰çš„åŸºç¡€ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå®ƒæ˜¯ç”¨äºå®æ–½é‚»å±…æœç´¢çš„æ— ç›‘ç£å­¦ä¹ è€…ã€‚</p>
<p>å¦ä¸€æ–¹é¢ï¼ŒåŸºäºç›‘ç£çš„åŸºäºé‚»å±…çš„å­¦ä¹ å¯ç”¨äºåˆ†ç±»å’Œå›å½’ã€‚</p>
<h2>æ— ç›‘ç£çš„KNNå­¦ä¹ </h2>
<p>å¦‚è®¨è®ºçš„é‚£æ ·ï¼Œå­˜åœ¨è®¸å¤šç®—æ³•ï¼Œä¾‹å¦‚KNNå’ŒK-Meansï¼Œå®ƒä»¬éœ€è¦æœ€è¿‘é‚»å±…æœç´¢ã€‚è¿™å°±æ˜¯Scikit-learnå†³å®šå°†é‚»å±…æœç´¢éƒ¨åˆ†å®ç°ä¸ºè‡ªå·±çš„â€œå­¦ä¹ è€…â€çš„åŸå› ã€‚è¿›è¡Œé‚»å±…æœç´¢ä½œä¸ºå•ç‹¬çš„å­¦ä¹ è€…çš„åŸå› æ˜¯ï¼Œè®¡ç®—æ‰€æœ‰æˆå¯¹è·ç¦»æ¥æŸ¥æ‰¾æœ€è¿‘çš„é‚»å±…æ˜¾ç„¶ä¸æ˜¯å¾ˆæœ‰æ•ˆã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹Sklearnç”¨äºå®ç°æ— ç›‘ç£çš„æœ€è¿‘é‚»å±…å­¦ä¹ çš„æ¨¡å—ä»¥åŠç¤ºä¾‹ã€‚</p>
<h3>Scikitå­¦ä¹ æ¨¡å—</h3>
<p><strong>sklearn.neighbors.NearestNeighbors</strong>æ˜¯ç”¨äºå®æ–½æ— ç›‘ç£çš„æœ€è¿‘é‚»å±…å­¦ä¹ çš„æ¨¡å—ã€‚å®ƒä½¿ç”¨åä¸ºBallTreeï¼ŒKDTreeæˆ–è›®åŠ›çš„ç‰¹å®šæœ€è¿‘é‚»å±…ç®—æ³•ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒå……å½“è¿™ä¸‰ç§ç®—æ³•çš„ç»Ÿä¸€æ¥å£ã€‚</p>
<p><strong>å®æ–½å®ä¾‹</strong></p>
<p>ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨<strong>sklearn.neighbors.NearestNeighbors</strong>æ¨¡å—åœ¨ä¸¤ç»„æ•°æ®ä¹‹é—´æ‰¾åˆ°æœ€æ¥è¿‘çš„é‚»å±…ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å¯¼å…¥æ‰€éœ€çš„æ¨¡å—å’Œè½¯ä»¶åŒ…-</p>
<pre><code class="python">from sklearn.neighbors import NearestNeighbors
import numpy as np
</code></pre>

<p>ç°åœ¨ï¼Œåœ¨å¯¼å…¥åŒ…ä¹‹åï¼Œåœ¨æˆ‘ä»¬è¦æŸ¥æ‰¾æœ€è¿‘çš„é‚»å±…ä¹‹é—´å®šä¹‰æ•°æ®é›†-</p>
<pre><code class="python">Input_data = np.array([[-1, 1], [-2, 2], [-3, 3], [1, 2], [2, 3], [3, 4],[4, 5]])
</code></pre>

<p>æ¥ä¸‹æ¥ï¼Œåº”ç”¨æ— ç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="python">nrst_neigh = NearestNeighbors(n_neighbors = 3, algorithm = 'ball_tree')
</code></pre>

<p>æ¥ä¸‹æ¥ï¼Œä½¿ç”¨è¾“å…¥æ•°æ®é›†æ‹Ÿåˆæ¨¡å‹ã€‚</p>
<pre><code class="python">nrst_neigh.fit(Input_data)
</code></pre>

<p>ç°åœ¨ï¼Œæ‰¾åˆ°æ•°æ®é›†çš„Ké‚»å±…ã€‚å®ƒå°†è¿”å›æ¯ä¸ªç‚¹çš„é‚»å±…çš„ç´¢å¼•å’Œè·ç¦»ã€‚</p>
<pre><code class="python">distances, indices = nrst_neigh.kneighbors(Input_data)
indices
</code></pre>

<p>ä¸Šé¢çš„è¾“å‡ºæ˜¾ç¤ºæ¯ä¸ªç‚¹çš„æœ€è¿‘é‚»å±…æ˜¯è¯¥ç‚¹æœ¬èº«ï¼Œå³é›¶ã€‚è¿™æ˜¯å› ä¸ºæŸ¥è¯¢é›†ä¸è®­ç»ƒé›†åŒ¹é…ã€‚</p>
<p>æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ç”Ÿæˆå¦‚ä¸‹çš„ç¨€ç–å›¾æ¥æ˜¾ç¤ºç›¸é‚»ç‚¹ä¹‹é—´çš„è¿æ¥-</p>
<pre><code class="python">nrst_neigh.kneighbors_graph(Input_data).toarray()
</code></pre>

<p>ä¸€æ—¦æˆ‘ä»¬æ‹Ÿåˆäº†æ— ç›‘ç£çš„<strong>NearestNeighbors</strong>æ¨¡å‹ï¼Œæ•°æ®å°†åŸºäºä¸ºå‚æ•°<strong>'algorithm'</strong>è®¾ç½®çš„å€¼å­˜å‚¨åœ¨æ•°æ®ç»“æ„ä¸­ã€‚åœ¨æ­¤ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ— äººç›‘ç£å­¦ä¹ è€…çš„<strong>kneighbors</strong>åœ¨éœ€è¦é‚»å±…çš„æœç´¢çš„æ¨¡å¼ã€‚</p>
<p><strong>å®Œæ•´çš„å·¥ä½œ/å¯æ‰§è¡Œç¨‹åº</strong></p>
<pre><code class="python">from sklearn.neighbors import NearestNeighbors
import numpy as np
Input_data = np.array([[-1, 1], [-2, 2], [-3, 3], [1, 2], [2, 3], [3, 4],[4, 5]])
nrst_neigh = NearestNeighbors(n_neighbors = 3, algorithm='ball_tree')
nrst_neigh.fit(Input_data)
distances, indices = nrst_neigh.kneighbors(Input_data)
indices
distances
nrst_neigh.kneighbors_graph(Input_data).toarray()
</code></pre>

<h2>ç›‘ç£KNNå­¦ä¹ </h2>
<p>åŸºäºç›‘ç£çš„åŸºäºé‚»å±…çš„å­¦ä¹ ç”¨äº-</p>
<ul>
<li>åˆ†ç±»ï¼Œç”¨äºå¸¦æœ‰ç¦»æ•£æ ‡ç­¾çš„æ•°æ®</li>
<li>å›å½’ï¼Œç”¨äºå¸¦æœ‰è¿ç»­æ ‡ç­¾çš„æ•°æ®ã€‚</li>
</ul>
<h3>æœ€è¿‘é‚»åˆ†ç±»å™¨</h3>
<p>æˆ‘ä»¬å¯ä»¥å€ŸåŠ©ä»¥ä¸‹ä¸¤ä¸ªç‰¹å¾æ¥äº†è§£åŸºäºé‚»å±…çš„åˆ†ç±»-</p>
<ul>
<li>å®ƒæ˜¯æ ¹æ®æ¯ä¸ªç‚¹çš„æœ€è¿‘é‚»å±…çš„ç®€å•å¤šæ•°ç¥¨è®¡ç®—å¾—å‡ºçš„ã€‚</li>
<li>å®ƒåªæ˜¯å­˜å‚¨åŸ¹è®­æ•°æ®çš„å®ä¾‹ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒæ˜¯ä¸€ç§éä¸€èˆ¬æ€§å­¦ä¹ çš„åŸå› ã€‚</li>
</ul>
<h3>Sklearnæ¨¡å—</h3>
<p>ä»¥ä¸‹æ˜¯scikit-learnä½¿ç”¨çš„ä¸¤ç§ä¸åŒç±»å‹çš„æœ€è¿‘é‚»å±…åˆ†ç±»å™¨-</p>
<table>
<thead>
<tr>
<th>åºå·</th>
<th>åˆ†ç±»å™¨å’Œè¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>1ã€‚</td>
<td>KNeighborsClassifierè¯¥åˆ†ç±»å™¨åç§°ä¸­çš„Kä»£è¡¨kä¸ªæœ€è¿‘é‚»å±…ï¼Œå…¶ä¸­kæ˜¯ç”¨æˆ·æŒ‡å®šçš„æ•´æ•°å€¼ã€‚å› æ­¤ï¼Œé¡¾åæ€ä¹‰ï¼Œè¯¥åˆ†ç±»å™¨åŸºäºkä¸ªæœ€è¿‘çš„é‚»å±…å®ç°å­¦ä¹ ã€‚kå€¼çš„é€‰æ‹©å–å†³äºæ•°æ®ã€‚</td>
</tr>
<tr>
<td>2ã€‚</td>
<td>RadiusNeighborsClassifieræ­¤åˆ†ç±»å™¨åç§°ä¸­çš„åŠå¾„è¡¨ç¤ºæŒ‡å®šåŠå¾„rå†…çš„æœ€è¿‘é‚»å±…ï¼Œå…¶ä¸­ræ˜¯ç”¨æˆ·æŒ‡å®šçš„æµ®ç‚¹å€¼ã€‚å› æ­¤ï¼Œé¡¾åæ€ä¹‰ï¼Œè¯¥åˆ†ç±»å™¨åŸºäºæ¯ä¸ªè®­ç»ƒç‚¹çš„å›ºå®šåŠå¾„rå†…çš„é‚»å±…æ•°å®ç°å­¦ä¹ ã€‚</td>
</tr>
</tbody>
</table>
<h2>æœ€è¿‘é‚»å±…å›å½’</h2>
<p>å®ƒåœ¨æ•°æ®æ ‡ç­¾æœ¬è´¨ä¸Šæ˜¯è¿ç»­çš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚åˆ†é…çš„æ•°æ®æ ‡ç­¾æ˜¯åŸºäºå…¶æœ€è¿‘é‚»å±…æ ‡ç­¾çš„å¹³å‡å€¼è®¡ç®—çš„ã€‚</p>
<p>ä»¥ä¸‹æ˜¯scikit-learnä½¿ç”¨çš„ä¸¤ç§ä¸åŒç±»å‹çš„æœ€è¿‘é‚»å±…å›å½’å™¨-</p>
<h2>KNeighborsRegressor</h2>
<p>æ­¤å›å½’å™¨åç§°ä¸­çš„Kè¡¨ç¤ºkä¸ªæœ€è¿‘çš„é‚»å±…ï¼Œå…¶ä¸­<strong>k</strong>æ˜¯ç”¨æˆ·æŒ‡å®šçš„<strong>æ•´æ•°å€¼</strong>ã€‚å› æ­¤ï¼Œé¡¾åæ€ä¹‰ï¼Œè¯¥å›å½’å™¨åŸºäºæœ€è¿‘çš„kä¸ªé‚»å±…å®ç°å­¦ä¹ ã€‚kå€¼çš„é€‰æ‹©å–å†³äºæ•°æ®ã€‚è®©æˆ‘ä»¬å€ŸåŠ©ä¸€ä¸ªå®ç°ç¤ºä¾‹æ¥è¿›ä¸€æ­¥äº†è§£å®ƒã€‚</p>
<p>ä»¥ä¸‹æ˜¯scikit-learnä½¿ç”¨çš„ä¸¤ç§ä¸åŒç±»å‹çš„æœ€è¿‘é‚»å±…å›å½’å™¨-</p>
<h3>å®æ–½å®ä¾‹</h3>
<p>åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨scikit-learn <strong>KNeighborsRegressor</strong>åœ¨åä¸ºIris Floweræ•°æ®é›†çš„æ•°æ®é›†ä¸Šå®ç°KNN ã€‚</p>
<p>é¦–å…ˆï¼ŒæŒ‰ä»¥ä¸‹æ–¹å¼å¯¼å…¥IRISæ•°æ®é›†-</p>
<pre><code class="python">from sklearn.datasets import load_iris
iris = load_iris()
</code></pre>

<p>ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦å°†æ•°æ®åˆ†ä¸ºè®­ç»ƒå’Œæµ‹è¯•æ•°æ®ã€‚æˆ‘ä»¬å°†ä½¿ç”¨Sklearn <strong>train_test_split</strong>å‡½æ•°å°†æ•°æ®åˆ†æˆ70ï¼ˆè®­ç»ƒæ•°æ®ï¼‰å’Œ20ï¼ˆæµ‹è¯•æ•°æ®ï¼‰çš„æ¯”ç‡-</p>
<pre><code class="python">X = iris.data[:, :4]
y = iris.target
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.20)
</code></pre>

<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åœ¨Sklearné¢„å¤„ç†æ¨¡å—çš„å¸®åŠ©ä¸‹è¿›è¡Œæ•°æ®ç¼©æ”¾-</p>
<pre><code class="python">from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
scaler.fit(X_train)
X_train = scaler.transform(X_train)
X_test = scaler.transform(X_test)
</code></pre>

<p>æ¥ä¸‹æ¥ï¼Œä»Sklearn å¯¼å…¥<strong>KNeighborsRegressor</strong>ç±»ï¼Œå¹¶æŒ‰å¦‚ä¸‹æ‰€ç¤ºæä¾›é‚»å±…çš„å€¼ã€‚</p>
<pre><code class="python">import numpy as np
from sklearn.neighbors import KNeighborsRegressor
knnr = KNeighborsRegressor(n_neighbors = 8)
knnr.fit(X_train, y_train)
</code></pre>

<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°MSEï¼ˆå‡æ–¹è¯¯å·®ï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="python">print(&quot;The MSE is:&quot;,format(np.power(y-knnr.predict(X),4).mean()))
</code></pre>

<p>ç°åœ¨ï¼Œä½¿ç”¨å®ƒæ¥é¢„æµ‹å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="python">X = [[0], [1], [2], [3]]
y = [0, 0, 1, 1]
from sklearn.neighbors import KNeighborsRegressor
knnr = KNeighborsRegressor(n_neighbors = 3)
knnr.fit(X, y)
print(knnr.predict([[2.5]]))
</code></pre>

<h3>å®Œæ•´ç¤ºä¾‹</h3>
<pre><code class="python">from sklearn.datasets import load_iris
iris = load_iris()
X = iris.data[:, :4]
y = iris.target
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20)
from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()

scaler.fit(X_train)
X_train = scaler.transform(X_train)
X_test = scaler.transform(X_test)

import numpy as np
from sklearn.neighbors import KNeighborsRegressor
knnr = KNeighborsRegressor(n_neighbors=8)
knnr.fit(X_train, y_train)

print(&quot;The MSE is:&quot;,format(np.power(y-knnr.predict(X),4).mean()))

X = [[0], [1], [2], [3]]
y = [0, 0, 1, 1]
from sklearn.neighbors import KNeighborsRegressor
knnr = KNeighborsRegressor(n_neighbors=3)
knnr.fit(X, y)
print(knnr.predict([[2.5]]))
</code></pre>

<h2>RadiusNeighborsRegressor</h2>
<p>æ­¤å›å½’å™¨åç§°ä¸­çš„åŠå¾„è¡¨ç¤ºæŒ‡å®šåŠå¾„rå†…æœ€è¿‘çš„é‚»å±…ï¼Œå…¶ä¸­ræ˜¯ç”¨æˆ·æŒ‡å®šçš„æµ®ç‚¹å€¼ã€‚å› æ­¤ï¼Œé¡¾åæ€ä¹‰ï¼Œè¯¥å›å½’å™¨åŸºäºæ¯ä¸ªè®­ç»ƒç‚¹çš„å›ºå®šåŠå¾„rå†…çš„é‚»å±…æ•°å®ç°å­¦ä¹ ã€‚è®©æˆ‘ä»¬åœ¨ä¸€ä¸ªå®ç°ç¤ºä¾‹çš„å¸®åŠ©ä¸‹æ›´åŠ äº†è§£å®ƒ-</p>
<h3>å®æ–½å®ä¾‹</h3>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šå¯¹æ•°æ®å®æ–½KNNé›†ä½¿ç”¨scikitå­¦ä¹ å‘½åçš„é¸¢å°¾èŠ±æ•°æ®é›†<strong>RadiusNeighborsRegressor</strong> -</p>
<p>é¦–å…ˆï¼ŒæŒ‰ä»¥ä¸‹æ–¹å¼å¯¼å…¥IRISæ•°æ®é›†-</p>
<pre><code class="python">from sklearn.datasets import load_iris
iris = load_iris()
</code></pre>

<p>ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦å°†æ•°æ®åˆ†ä¸ºè®­ç»ƒå’Œæµ‹è¯•æ•°æ®ã€‚æˆ‘ä»¬å°†ä½¿ç”¨Sklearn train_test_splitå‡½æ•°å°†æ•°æ®åˆ†æˆ70ï¼ˆè®­ç»ƒæ•°æ®ï¼‰å’Œ20ï¼ˆæµ‹è¯•æ•°æ®ï¼‰çš„æ¯”ç‡-</p>
<pre><code class="python">X = iris.data[:, :4]
y = iris.target
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20)
</code></pre>

<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åœ¨Sklearné¢„å¤„ç†æ¨¡å—çš„å¸®åŠ©ä¸‹è¿›è¡Œæ•°æ®ç¼©æ”¾-</p>
<pre><code class="python">from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
scaler.fit(X_train)
X_train = scaler.transform(X_train)
X_test = scaler.transform(X_test)
</code></pre>

<p>æ¥ä¸‹æ¥ï¼Œä»Sklearn å¯¼å…¥<strong>RadiusneighborsRegressor</strong>ç±»ï¼Œå¹¶æä¾›radiusçš„å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="python">import numpy as np
from sklearn.neighbors import RadiusNeighborsRegressor
knnr_r = RadiusNeighborsRegressor(radius=1)
knnr_r.fit(X_train, y_train)
</code></pre>

<p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°MSEï¼ˆå‡æ–¹è¯¯å·®ï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="python">print(&quot;The MSE is:&quot;,format(np.power(y-knnr_r.predict(X),4).mean()))
</code></pre>

<p>ç°åœ¨ï¼Œä½¿ç”¨å®ƒæ¥é¢„æµ‹å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="python">X = [[0], [1], [2], [3]]
y = [0, 0, 1, 1]
from sklearn.neighbors import RadiusNeighborsRegressor
knnr_r = RadiusNeighborsRegressor(radius=1)
knnr_r.fit(X, y)
print(knnr_r.predict([[2.5]]))
</code></pre>

<h3>å®Œæ•´çš„å·¥ä½œ/å¯æ‰§è¡Œç¨‹åº</h3>
<pre><code class="python">from sklearn.datasets import load_iris

iris = load_iris()

X = iris.data[:, :4]
y = iris.target
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.20)
from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
scaler.fit(X_train)
X_train = scaler.transform(X_train)
X_test = scaler.transform(X_test)
import numpy as np
from sklearn.neighbors import RadiusNeighborsRegressor
knnr_r = RadiusNeighborsRegressor(radius = 1)
knnr_r.fit(X_train, y_train)
print(&quot;The MSE is:&quot;,format(np.power(y-knnr_r.predict(X),4).mean()))
X = [[0], [1], [2], [3]]
y = [0, 0, 1, 1]
from sklearn.neighbors import RadiusNeighborsRegressor
knnr_r = RadiusNeighborsRegressor(radius = 1)
knnr_r.fit(X, y)
print(knnr_r.predict([[2.5]]))
</code></pre>
          </div>
          <backend type='k'></backend>
          <code class=gatsby-kernelname data-language=python></code>
        </div> <!-- / .row -->
      </div>
      
    </section>

    <!-- JAVASCRIPT
    ================================================== -->
    <!-- Libs JS -->
    <script src="https://landkit.goodthemes.co/assets/libs/jquery/dist/jquery.min.js"></script>
    <script src="https://landkit.goodthemes.co/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Theme JS -->
    <script src="https://landkit.goodthemes.co/assets/js/theme.min.js"></script>
    <script src="https://cdn.freeaihub.com/asset/js/cell.js"></script>
          
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script>
    MathJax = {
      tex: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
    };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  </body>
</html>