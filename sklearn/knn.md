# sklearn Kè¿‘é‚»(KNN)

æœ¬ç« å°†å¸®åŠ©æ‚¨äº†è§£Sklearnä¸­æœ€æ¥è¿‘çš„é‚»å±…æ–¹æ³•ã€‚

åŸºäºé‚»å±…çš„å­¦ä¹ æ–¹æ³•æœ‰ä¸¤ç§ç±»å‹ï¼Œå³æœ‰**ç›‘ç£çš„**å’Œ**æ— ç›‘ç£çš„ã€‚**åŸºäºç›‘ç£çš„åŸºäºé‚»å±…çš„å­¦ä¹ æ—¢å¯ä»¥ç”¨äºåˆ†ç±»é¢„æµ‹é—®é¢˜ï¼Œä¹Ÿå¯ä»¥ç”¨äºå›å½’é¢„æµ‹é—®é¢˜ï¼Œä½†æ˜¯å®ƒä¸»è¦ç”¨äºè¡Œä¸šä¸­çš„åˆ†ç±»é¢„æµ‹é—®é¢˜ã€‚

åŸºäºé‚»å±…çš„å­¦ä¹ æ–¹æ³•æ²¡æœ‰ä¸“é—¨çš„è®­ç»ƒé˜¶æ®µï¼Œè€Œæ˜¯åœ¨åˆ†ç±»æ—¶å°†æ‰€æœ‰æ•°æ®ç”¨äºè®­ç»ƒã€‚å®ƒè¿˜ä¸å‡å®šæœ‰å…³åŸºç¡€æ•°æ®çš„ä»»ä½•ä¿¡æ¯ã€‚è¿™å°±æ˜¯å®ƒä»¬æœ¬è´¨ä¸Šæ˜¯æƒ°æ€§å’Œéå‚æ•°åŒ–çš„åŸå› ã€‚

æœ€è¿‘é‚»å±…æ–¹æ³•èƒŒåçš„ä¸»è¦åŸç†æ˜¯-

- æŸ¥æ‰¾è·ç¦»æ–°æ•°æ®ç‚¹æœ€è¿‘çš„å£æ©±ä¸­é¢„å®šæ•°é‡çš„è®­ç»ƒæ ·æœ¬
- ä»è¿™äº›æ•°é‡çš„è®­ç»ƒæ ·æœ¬ä¸­é¢„æµ‹æ ‡ç­¾ã€‚

åœ¨è¿™é‡Œï¼Œæ ·æœ¬æ•°å¯ä»¥æ˜¯ç”¨æˆ·å®šä¹‰çš„å¸¸æ•°ï¼Œä¾‹å¦‚åœ¨Kè¿‘é‚»å­¦ä¹ ä¸­ï¼Œä¹Ÿå¯ä»¥æ ¹æ®ç‚¹çš„å±€éƒ¨å¯†åº¦è€Œå˜åŒ–ï¼Œä¾‹å¦‚åœ¨åŸºäºåŠå¾„çš„é‚»å±…å­¦ä¹ ä¸­ã€‚

### sklearn.neighborsæ¨¡å—

Scikit-learnå…·æœ‰**sklearn.neighbors**æ¨¡å—ï¼Œè¯¥æ¨¡å—ä¸ºæ— ç›‘ç£å’Œå—ç›‘ç£çš„åŸºäºé‚»å±…çš„å­¦ä¹ æ–¹æ³•æä¾›åŠŸèƒ½ã€‚ä½œä¸ºè¾“å…¥ï¼Œæ­¤æ¨¡å—ä¸­çš„ç±»å¯ä»¥å¤„ç†NumPyæ•°ç»„æˆ–**scipy.sparse**çŸ©é˜µã€‚

## ç®—æ³•ç±»å‹

å¯ä»¥åœ¨åŸºäºé‚»å±…çš„æ–¹æ³•çš„å®ç°ä¸­ä½¿ç”¨çš„ä¸åŒç±»å‹çš„ç®—æ³•å¦‚ä¸‹-

### è›®åŠ›

æ•°æ®é›†ä¸­æ‰€æœ‰ç‚¹å¯¹ä¹‹é—´è·ç¦»çš„å¼ºåŠ›è®¡ç®—æä¾›äº†æœ€å¹¼ç¨šçš„é‚»å±…æœç´¢å®ç°ã€‚ä»æ•°å­¦ä¸Šæ¥è¯´ï¼Œå¯¹äºDä¸ªç»´åº¦ä¸Šçš„Nä¸ªæ ·æœ¬ï¼Œè›®åŠ›æ–¹æ³•çš„ç¼©æ”¾æ¯”ä¾‹ä¸º***0 [DN 2 ]\***

å¯¹äºå°æ•°æ®æ ·æœ¬ï¼Œæ­¤ç®—æ³•å¯èƒ½éå¸¸æœ‰ç”¨ï¼Œä½†æ˜¯éšç€æ ·æœ¬æ•°é‡çš„å¢åŠ ï¼Œå®ƒå˜å¾—ä¸å¯è¡Œã€‚å¯ä»¥é€šè¿‡ç¼–å†™å…³é”®å­—**algorithm ='brute'**æ¥å¯ç”¨è›®åŠ›é‚»å±…æœç´¢ã€‚

### KDæ ‘

ä¸ºäº†è§£å†³æš´åŠ›ç ´è§£æ–¹æ³•çš„è®¡ç®—æ•ˆç‡ä½ä¸‹è€Œå‘æ˜çš„åŸºäºæ ‘çš„æ•°æ®ç»“æ„ä¹‹ä¸€å°±æ˜¯KDæ ‘æ•°æ®ç»“æ„ã€‚åŸºæœ¬ä¸Šï¼ŒKDæ ‘æ˜¯ä¸€ç§äºŒå‰æ ‘ç»“æ„ï¼Œç§°ä¸ºKç»´æ ‘ã€‚å®ƒé€šè¿‡å°†å‚æ•°ç©ºé—´åˆ’åˆ†ä¸ºåµŒå¥—çš„æ­£äº¤åŒºåŸŸæ¥å¡«å……æ•°æ®ç‚¹ï¼Œä»è€Œæ²¿æ•°æ®è½´é€’å½’åˆ’åˆ†å‚æ•°ç©ºé—´ã€‚

### ä¼˜ç‚¹

ä»¥ä¸‹æ˜¯KDæ ‘ç®—æ³•çš„ä¸€äº›ä¼˜ç‚¹-

**æ„é€ é€Ÿåº¦å¿«** -ç”±äºä»…æ²¿æ•°æ®è½´æ‰§è¡Œåˆ†åŒºï¼Œå› æ­¤KDæ ‘çš„æ„é€ é€Ÿåº¦éå¸¸å¿«ã€‚

**æ›´å°‘çš„è·ç¦»è®¡ç®—** -è¯¥ç®—æ³•åªéœ€å¾ˆå°‘çš„è·ç¦»è®¡ç®—å³å¯ç¡®å®šæŸ¥è¯¢ç‚¹çš„æœ€è¿‘é‚»å±…ã€‚å®ƒåªéœ€è¦**ğ‘¶[ğ¥ğ¨ğ ï¼ˆğ‘µï¼‰]ä¸ª**è·ç¦»è®¡ç®—ã€‚

### ç¼ºç‚¹

**ä»…å¯¹ä½ç»´é‚»å±…æœç´¢**å¿«é€Ÿ-å¯¹ä½ç»´ï¼ˆD <20ï¼‰é‚»å±…æœç´¢éå¸¸å¿«ï¼Œä½†æ˜¯éšç€Dçš„å¢é•¿ï¼Œå®ƒå˜å¾—æ— æ•ˆã€‚ç”±äºä»…æ²¿æ•°æ®è½´æ‰§è¡Œåˆ†åŒºï¼Œ

å¯ä»¥é€šè¿‡ç¼–å†™å…³é”®å­—**algorithm ='kd_tree'**æ¥å¯ç”¨KDæ ‘é‚»å±…æœç´¢ã€‚

### çƒæ ‘

ä¼—æ‰€å‘¨çŸ¥ï¼ŒKDæ ‘åœ¨é«˜ç»´æ–¹é¢æ•ˆç‡ä½ä¸‹ï¼Œå› æ­¤ï¼Œä¸ºäº†è§£å†³KDæ ‘çš„è¿™ç§ä½æ•ˆç‡é—®é¢˜ï¼Œå¼€å‘äº†çƒæ ‘æ•°æ®ç»“æ„ã€‚åœ¨æ•°å­¦ä¸Šï¼Œå®ƒå°†æ•°æ®é€’å½’åœ°åˆ†ä¸ºè´¨å¿ƒCå’ŒåŠå¾„rå®šä¹‰çš„èŠ‚ç‚¹ï¼Œä»¥ä½¿èŠ‚ç‚¹ä¸­çš„æ¯ä¸ªç‚¹éƒ½ä½äºè´¨å¿ƒ**C**å’ŒåŠå¾„**r**å®šä¹‰çš„è¶…çƒé¢å†…ã€‚å®ƒä½¿ç”¨ä¸‹é¢ç»™å‡ºçš„ä¸‰è§’å½¢ä¸ç­‰å¼ï¼Œä»è€Œå‡å°‘äº†é‚»å±…æœç´¢çš„å€™é€‰ç‚¹æ•°

$$
\arrowvert X+Y\arrowvert\leq \arrowvert X\arrowvert+\arrowvert Y\arrowvert
$$

### ä¼˜ç‚¹

ä»¥ä¸‹æ˜¯Ball Treeç®—æ³•çš„ä¸€äº›ä¼˜ç‚¹-

**é«˜æ•ˆå¤„ç†é«˜åº¦ç»“æ„åŒ–çš„æ•°æ®** -ç”±äºçƒå½¢æ ‘å°†æ•°æ®åˆ’åˆ†ä¸ºä¸€ç³»åˆ—åµŒå¥—çš„è¶…çƒä½“ï¼Œå› æ­¤å¯¹é«˜æ•ˆå¤„ç†é«˜åº¦ç»“æ„åŒ–çš„æ•°æ®éå¸¸æœ‰æ•ˆã€‚

**è¡¨ç°ä¼˜äºKDæ ‘** -çƒæ ‘åœ¨é«˜ç»´æ–¹é¢è¡¨ç°ä¼˜äºKDæ ‘ï¼Œå› ä¸ºå®ƒå…·æœ‰çƒæ ‘èŠ‚ç‚¹çš„çƒå½¢å‡ ä½•å½¢çŠ¶ã€‚

### ç¼ºç‚¹

æˆæœ¬**é«˜æ˜‚** -å°†æ•°æ®åˆ’åˆ†ä¸ºä¸€ç³»åˆ—åµŒå¥—çš„è¶…çƒä½“ï¼Œä½¿å…¶æ„å»ºæˆæœ¬å¾ˆé«˜ã€‚

å¯ä»¥é€šè¿‡ç¼–å†™å…³é”®å­—**algorithm ='ball_tree'**æ¥å¯ç”¨çƒæ ‘é‚»å±…æœç´¢ã€‚

## é€‰æ‹©æœ€è¿‘é‚»å±…ç®—æ³•

ç»™å®šæ•°æ®é›†çš„æœ€ä½³ç®—æ³•çš„é€‰æ‹©å–å†³äºä»¥ä¸‹å› ç´ -

### æ ·æœ¬æ•°ï¼ˆNï¼‰å’Œç»´æ•°ï¼ˆDï¼‰

è¿™äº›æ˜¯é€‰æ‹©æœ€è¿‘é‚»å±…ç®—æ³•æ—¶è¦è€ƒè™‘çš„æœ€é‡è¦å› ç´ ã€‚è¿™æ˜¯ç”±äºä»¥ä¸‹åŸå› -

- è›®åŠ›ç®—æ³•çš„æŸ¥è¯¢æ—¶é—´éšç€O [DN]çš„å¢é•¿è€Œå¢åŠ ã€‚
- çƒæ ‘ç®—æ³•çš„æŸ¥è¯¢æ—¶é—´éšç€O [D logï¼ˆNï¼‰]è€Œå¢é•¿ã€‚
- KDæ ‘ç®—æ³•çš„æŸ¥è¯¢æ—¶é—´éšDçš„å˜åŒ–è€Œå˜åŒ–ï¼Œè¿™å¾ˆéš¾æè¿°ã€‚å½“D <20æ—¶ï¼Œæˆæœ¬ä¸ºO [D logï¼ˆNï¼‰]ï¼Œè¯¥ç®—æ³•éå¸¸æœ‰æ•ˆã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨D> 20çš„æƒ…å†µä¸‹æ•ˆç‡ä½ä¸‹ï¼Œå› ä¸ºæˆæœ¬å¢åŠ åˆ°æ¥è¿‘O [DN]ã€‚

### æ•°æ®ç»“æ„

å½±å“è¿™äº›ç®—æ³•æ€§èƒ½çš„å¦ä¸€ä¸ªå› ç´ æ˜¯æ•°æ®çš„å›ºæœ‰ç»´æ•°æˆ–æ•°æ®çš„ç¨€ç–æ€§ã€‚è¿™æ˜¯å› ä¸ºçƒæ ‘å’ŒKDæ ‘ç®—æ³•çš„æŸ¥è¯¢æ—¶é—´ä¼šå—åˆ°å¾ˆå¤§çš„å½±å“ã€‚è€Œè›®åŠ›ç®—æ³•çš„æŸ¥è¯¢æ—¶é—´åœ¨æ•°æ®ç»“æ„ä¸Šæ˜¯ä¸å˜çš„ã€‚é€šå¸¸ï¼Œå½“æ¤å…¥å…·æœ‰è¾ƒå°å›ºæœ‰ç»´æ•°çš„ç¨€ç–æ•°æ®æ—¶ï¼Œçƒæ ‘å’ŒKDæ ‘ç®—æ³•ä¼šäº§ç”Ÿæ›´å¿«çš„æŸ¥è¯¢æ—¶é—´ã€‚

### é‚»å±…æ•°ï¼ˆkï¼‰

è¯·æ±‚ä¸€ä¸ªæŸ¥è¯¢ç‚¹çš„é‚»å±…æ•°ï¼ˆkï¼‰å½±å“çƒæ ‘å’ŒKDæ ‘ç®—æ³•çš„æŸ¥è¯¢æ—¶é—´ã€‚éšç€é‚»å±…æ•°ï¼ˆkï¼‰çš„å¢åŠ ï¼ŒæŸ¥è¯¢æ—¶é—´å˜æ…¢ã€‚è€Œè›®åŠ›çš„æŸ¥è¯¢æ—¶é—´å°†ä¸å—kå€¼çš„å½±å“ã€‚

### æŸ¥è¯¢ç‚¹æ•°

å› ä¸ºå®ƒä»¬éœ€è¦æ„é€ é˜¶æ®µï¼Œæ‰€ä»¥å¦‚æœå­˜åœ¨å¤§é‡æŸ¥è¯¢ç‚¹ï¼Œåˆ™KDæ ‘ç®—æ³•å’ŒBallæ ‘ç®—æ³•éƒ½å°†æœ‰æ•ˆã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœæŸ¥è¯¢ç‚¹æ•°é‡è¾ƒå°‘ï¼Œåˆ™è›®åŠ›ç®—æ³•çš„æ€§èƒ½è¦ä¼˜äºKDæ ‘å’ŒBallæ ‘ç®—æ³•ã€‚



## KNNå®ç°

k-NNï¼ˆkæœ€è¿‘é‚»ï¼‰æ˜¯æœ€ç®€å•çš„æœºå™¨å­¦ä¹ ç®—æ³•ä¹‹ä¸€ï¼Œæœ¬è´¨ä¸Šæ˜¯éå‚æ•°çš„å’Œæƒ°æ€§çš„ã€‚éå‚æ•°æ„å‘³ç€æ²¡æœ‰åŸºç¡€æ•°æ®åˆ†å¸ƒçš„å‡è®¾ï¼Œå³ä»æ•°æ®é›†ä¸­ç¡®å®šäº†æ¨¡å‹ç»“æ„ã€‚æ‡’æƒ°æˆ–åŸºäºå®ä¾‹çš„å­¦ä¹ æ„å‘³ç€ï¼Œå‡ºäºæ¨¡å‹ç”Ÿæˆçš„ç›®çš„ï¼Œå®ƒä¸éœ€è¦ä»»ä½•è®­ç»ƒæ•°æ®ç‚¹ï¼Œå¹¶ä¸”åœ¨æµ‹è¯•é˜¶æ®µå°†ä½¿ç”¨æ•´ä¸ªè®­ç»ƒæ•°æ®ã€‚

k-NNç®—æ³•åŒ…æ‹¬ä»¥ä¸‹ä¸¤ä¸ªæ­¥éª¤-

### æ­¥éª¤1

åœ¨æ­¤æ­¥éª¤ä¸­ï¼Œå®ƒè®¡ç®—å¹¶å­˜å‚¨è®­ç»ƒé›†ä¸­æ¯ä¸ªæ ·æœ¬çš„kä¸ªæœ€è¿‘é‚»å±…ã€‚

### ç¬¬2æ­¥

åœ¨æ­¤æ­¥éª¤ä¸­ï¼Œå¯¹äºæœªæ ‡è®°çš„æ ·æœ¬ï¼Œå®ƒå°†ä»æ•°æ®é›†ä¸­æ£€ç´¢kä¸ªæœ€è¿‘çš„é‚»å±…ã€‚ç„¶åï¼Œåœ¨è¿™äº›kè¿‘é‚»ä¸­ï¼Œå®ƒé€šè¿‡æŠ•ç¥¨æ¥é¢„æµ‹ç­çº§ï¼ˆå¤šæ•°ç¥¨çš„ç­çº§è·èƒœï¼‰ã€‚

å®ç°kè¿‘é‚»ç®—æ³•çš„æ¨¡å—**sklearn.neighbors**æä¾›äº†**æ— ç›‘ç£**ä»¥åŠåŸºäº**ç›‘ç£**çš„åŸºäºé‚»å±…çš„å­¦ä¹ æ–¹æ³•çš„åŠŸèƒ½ã€‚

æ— ç›‘ç£çš„æœ€è¿‘é‚»å±…å®æ–½ä¸åŒçš„ç®—æ³•ï¼ˆBallTreeï¼ŒKDTreeæˆ–è›®åŠ›ï¼‰ä»¥æ‰¾åˆ°æ¯ä¸ªæ ·æœ¬çš„æœ€è¿‘é‚»å±…ã€‚æ­¤æ— ç›‘ç£ç‰ˆæœ¬åŸºæœ¬ä¸Šåªæ˜¯ä¸Šé¢è®¨è®ºçš„ç¬¬ä¸€æ­¥ï¼Œå¹¶ä¸”æ˜¯éœ€è¦é‚»å±…æœç´¢çš„è®¸å¤šç®—æ³•ï¼ˆKNNå’ŒK-meansæ˜¯è‘—åçš„ç®—æ³•ï¼‰çš„åŸºç¡€ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå®ƒæ˜¯ç”¨äºå®æ–½é‚»å±…æœç´¢çš„æ— ç›‘ç£å­¦ä¹ è€…ã€‚

å¦ä¸€æ–¹é¢ï¼ŒåŸºäºç›‘ç£çš„åŸºäºé‚»å±…çš„å­¦ä¹ å¯ç”¨äºåˆ†ç±»å’Œå›å½’ã€‚

## æ— ç›‘ç£çš„KNNå­¦ä¹ 

å¦‚è®¨è®ºçš„é‚£æ ·ï¼Œå­˜åœ¨è®¸å¤šç®—æ³•ï¼Œä¾‹å¦‚KNNå’ŒK-Meansï¼Œå®ƒä»¬éœ€è¦æœ€è¿‘é‚»å±…æœç´¢ã€‚è¿™å°±æ˜¯Scikit-learnå†³å®šå°†é‚»å±…æœç´¢éƒ¨åˆ†å®ç°ä¸ºè‡ªå·±çš„â€œå­¦ä¹ è€…â€çš„åŸå› ã€‚è¿›è¡Œé‚»å±…æœç´¢ä½œä¸ºå•ç‹¬çš„å­¦ä¹ è€…çš„åŸå› æ˜¯ï¼Œè®¡ç®—æ‰€æœ‰æˆå¯¹è·ç¦»æ¥æŸ¥æ‰¾æœ€è¿‘çš„é‚»å±…æ˜¾ç„¶ä¸æ˜¯å¾ˆæœ‰æ•ˆã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹Sklearnç”¨äºå®ç°æ— ç›‘ç£çš„æœ€è¿‘é‚»å±…å­¦ä¹ çš„æ¨¡å—ä»¥åŠç¤ºä¾‹ã€‚

### Scikitå­¦ä¹ æ¨¡å—

**sklearn.neighbors.NearestNeighbors**æ˜¯ç”¨äºå®æ–½æ— ç›‘ç£çš„æœ€è¿‘é‚»å±…å­¦ä¹ çš„æ¨¡å—ã€‚å®ƒä½¿ç”¨åä¸ºBallTreeï¼ŒKDTreeæˆ–è›®åŠ›çš„ç‰¹å®šæœ€è¿‘é‚»å±…ç®—æ³•ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒå……å½“è¿™ä¸‰ç§ç®—æ³•çš„ç»Ÿä¸€æ¥å£ã€‚

**å®æ–½å®ä¾‹**

ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨**sklearn.neighbors.NearestNeighbors**æ¨¡å—åœ¨ä¸¤ç»„æ•°æ®ä¹‹é—´æ‰¾åˆ°æœ€æ¥è¿‘çš„é‚»å±…ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å¯¼å…¥æ‰€éœ€çš„æ¨¡å—å’Œè½¯ä»¶åŒ…-

```python
from sklearn.neighbors import NearestNeighbors
import numpy as np
```

ç°åœ¨ï¼Œåœ¨å¯¼å…¥åŒ…ä¹‹åï¼Œåœ¨æˆ‘ä»¬è¦æŸ¥æ‰¾æœ€è¿‘çš„é‚»å±…ä¹‹é—´å®šä¹‰æ•°æ®é›†-

```python
Input_data = np.array([[-1, 1], [-2, 2], [-3, 3], [1, 2], [2, 3], [3, 4],[4, 5]])
```

æ¥ä¸‹æ¥ï¼Œåº”ç”¨æ— ç›‘ç£å­¦ä¹ ç®—æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```python
nrst_neigh = NearestNeighbors(n_neighbors = 3, algorithm = 'ball_tree')
```

æ¥ä¸‹æ¥ï¼Œä½¿ç”¨è¾“å…¥æ•°æ®é›†æ‹Ÿåˆæ¨¡å‹ã€‚

```python
nrst_neigh.fit(Input_data)
```

ç°åœ¨ï¼Œæ‰¾åˆ°æ•°æ®é›†çš„Ké‚»å±…ã€‚å®ƒå°†è¿”å›æ¯ä¸ªç‚¹çš„é‚»å±…çš„ç´¢å¼•å’Œè·ç¦»ã€‚

```python
distances, indices = nrst_neigh.kneighbors(Input_data)
indices
```

ä¸Šé¢çš„è¾“å‡ºæ˜¾ç¤ºæ¯ä¸ªç‚¹çš„æœ€è¿‘é‚»å±…æ˜¯è¯¥ç‚¹æœ¬èº«ï¼Œå³é›¶ã€‚è¿™æ˜¯å› ä¸ºæŸ¥è¯¢é›†ä¸è®­ç»ƒé›†åŒ¹é…ã€‚

æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ç”Ÿæˆå¦‚ä¸‹çš„ç¨€ç–å›¾æ¥æ˜¾ç¤ºç›¸é‚»ç‚¹ä¹‹é—´çš„è¿æ¥-

```python
nrst_neigh.kneighbors_graph(Input_data).toarray()
```

ä¸€æ—¦æˆ‘ä»¬æ‹Ÿåˆäº†æ— ç›‘ç£çš„**NearestNeighbors**æ¨¡å‹ï¼Œæ•°æ®å°†åŸºäºä¸ºå‚æ•°**'algorithm'**è®¾ç½®çš„å€¼å­˜å‚¨åœ¨æ•°æ®ç»“æ„ä¸­ã€‚åœ¨æ­¤ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ— äººç›‘ç£å­¦ä¹ è€…çš„**kneighbors**åœ¨éœ€è¦é‚»å±…çš„æœç´¢çš„æ¨¡å¼ã€‚

**å®Œæ•´çš„å·¥ä½œ/å¯æ‰§è¡Œç¨‹åº**

```python
from sklearn.neighbors import NearestNeighbors
import numpy as np
Input_data = np.array([[-1, 1], [-2, 2], [-3, 3], [1, 2], [2, 3], [3, 4],[4, 5]])
nrst_neigh = NearestNeighbors(n_neighbors = 3, algorithm='ball_tree')
nrst_neigh.fit(Input_data)
distances, indices = nrst_neigh.kneighbors(Input_data)
indices
distances
nrst_neigh.kneighbors_graph(Input_data).toarray()
```

## ç›‘ç£KNNå­¦ä¹ 

åŸºäºç›‘ç£çš„åŸºäºé‚»å±…çš„å­¦ä¹ ç”¨äº-

- åˆ†ç±»ï¼Œç”¨äºå¸¦æœ‰ç¦»æ•£æ ‡ç­¾çš„æ•°æ®
- å›å½’ï¼Œç”¨äºå¸¦æœ‰è¿ç»­æ ‡ç­¾çš„æ•°æ®ã€‚

### æœ€è¿‘é‚»åˆ†ç±»å™¨

æˆ‘ä»¬å¯ä»¥å€ŸåŠ©ä»¥ä¸‹ä¸¤ä¸ªç‰¹å¾æ¥äº†è§£åŸºäºé‚»å±…çš„åˆ†ç±»-

- å®ƒæ˜¯æ ¹æ®æ¯ä¸ªç‚¹çš„æœ€è¿‘é‚»å±…çš„ç®€å•å¤šæ•°ç¥¨è®¡ç®—å¾—å‡ºçš„ã€‚
- å®ƒåªæ˜¯å­˜å‚¨åŸ¹è®­æ•°æ®çš„å®ä¾‹ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒæ˜¯ä¸€ç§éä¸€èˆ¬æ€§å­¦ä¹ çš„åŸå› ã€‚

### Sklearnæ¨¡å—

ä»¥ä¸‹æ˜¯scikit-learnä½¿ç”¨çš„ä¸¤ç§ä¸åŒç±»å‹çš„æœ€è¿‘é‚»å±…åˆ†ç±»å™¨-

| åºå· | åˆ†ç±»å™¨å’Œè¯´æ˜                                                 |
| ---- | ------------------------------------------------------------ |
| 1ã€‚  | KNeighborsClassifierè¯¥åˆ†ç±»å™¨åç§°ä¸­çš„Kä»£è¡¨kä¸ªæœ€è¿‘é‚»å±…ï¼Œå…¶ä¸­kæ˜¯ç”¨æˆ·æŒ‡å®šçš„æ•´æ•°å€¼ã€‚å› æ­¤ï¼Œé¡¾åæ€ä¹‰ï¼Œè¯¥åˆ†ç±»å™¨åŸºäºkä¸ªæœ€è¿‘çš„é‚»å±…å®ç°å­¦ä¹ ã€‚kå€¼çš„é€‰æ‹©å–å†³äºæ•°æ®ã€‚ |
| 2ã€‚  | RadiusNeighborsClassifieræ­¤åˆ†ç±»å™¨åç§°ä¸­çš„åŠå¾„è¡¨ç¤ºæŒ‡å®šåŠå¾„rå†…çš„æœ€è¿‘é‚»å±…ï¼Œå…¶ä¸­ræ˜¯ç”¨æˆ·æŒ‡å®šçš„æµ®ç‚¹å€¼ã€‚å› æ­¤ï¼Œé¡¾åæ€ä¹‰ï¼Œè¯¥åˆ†ç±»å™¨åŸºäºæ¯ä¸ªè®­ç»ƒç‚¹çš„å›ºå®šåŠå¾„rå†…çš„é‚»å±…æ•°å®ç°å­¦ä¹ ã€‚ |

## æœ€è¿‘é‚»å±…å›å½’

å®ƒåœ¨æ•°æ®æ ‡ç­¾æœ¬è´¨ä¸Šæ˜¯è¿ç»­çš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚åˆ†é…çš„æ•°æ®æ ‡ç­¾æ˜¯åŸºäºå…¶æœ€è¿‘é‚»å±…æ ‡ç­¾çš„å¹³å‡å€¼è®¡ç®—çš„ã€‚

ä»¥ä¸‹æ˜¯scikit-learnä½¿ç”¨çš„ä¸¤ç§ä¸åŒç±»å‹çš„æœ€è¿‘é‚»å±…å›å½’å™¨-

## KNeighborsRegressor

æ­¤å›å½’å™¨åç§°ä¸­çš„Kè¡¨ç¤ºkä¸ªæœ€è¿‘çš„é‚»å±…ï¼Œå…¶ä¸­**k**æ˜¯ç”¨æˆ·æŒ‡å®šçš„**æ•´æ•°å€¼**ã€‚å› æ­¤ï¼Œé¡¾åæ€ä¹‰ï¼Œè¯¥å›å½’å™¨åŸºäºæœ€è¿‘çš„kä¸ªé‚»å±…å®ç°å­¦ä¹ ã€‚kå€¼çš„é€‰æ‹©å–å†³äºæ•°æ®ã€‚è®©æˆ‘ä»¬å€ŸåŠ©ä¸€ä¸ªå®ç°ç¤ºä¾‹æ¥è¿›ä¸€æ­¥äº†è§£å®ƒã€‚

ä»¥ä¸‹æ˜¯scikit-learnä½¿ç”¨çš„ä¸¤ç§ä¸åŒç±»å‹çš„æœ€è¿‘é‚»å±…å›å½’å™¨-

### å®æ–½å®ä¾‹

åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨scikit-learn **KNeighborsRegressor**åœ¨åä¸ºIris Floweræ•°æ®é›†çš„æ•°æ®é›†ä¸Šå®ç°KNN ã€‚

é¦–å…ˆï¼ŒæŒ‰ä»¥ä¸‹æ–¹å¼å¯¼å…¥IRISæ•°æ®é›†-

```python
from sklearn.datasets import load_iris
iris = load_iris()
```

ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦å°†æ•°æ®åˆ†ä¸ºè®­ç»ƒå’Œæµ‹è¯•æ•°æ®ã€‚æˆ‘ä»¬å°†ä½¿ç”¨Sklearn **train_test_split**å‡½æ•°å°†æ•°æ®åˆ†æˆ70ï¼ˆè®­ç»ƒæ•°æ®ï¼‰å’Œ20ï¼ˆæµ‹è¯•æ•°æ®ï¼‰çš„æ¯”ç‡-

```python
X = iris.data[:, :4]
y = iris.target
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.20)
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åœ¨Sklearné¢„å¤„ç†æ¨¡å—çš„å¸®åŠ©ä¸‹è¿›è¡Œæ•°æ®ç¼©æ”¾-

```python
from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
scaler.fit(X_train)
X_train = scaler.transform(X_train)
X_test = scaler.transform(X_test)
```

æ¥ä¸‹æ¥ï¼Œä»Sklearn å¯¼å…¥**KNeighborsRegressor**ç±»ï¼Œå¹¶æŒ‰å¦‚ä¸‹æ‰€ç¤ºæä¾›é‚»å±…çš„å€¼ã€‚

```python
import numpy as np
from sklearn.neighbors import KNeighborsRegressor
knnr = KNeighborsRegressor(n_neighbors = 8)
knnr.fit(X_train, y_train)
```

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°MSEï¼ˆå‡æ–¹è¯¯å·®ï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```python
print("The MSE is:",format(np.power(y-knnr.predict(X),4).mean()))
```

ç°åœ¨ï¼Œä½¿ç”¨å®ƒæ¥é¢„æµ‹å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```python
X = [[0], [1], [2], [3]]
y = [0, 0, 1, 1]
from sklearn.neighbors import KNeighborsRegressor
knnr = KNeighborsRegressor(n_neighbors = 3)
knnr.fit(X, y)
print(knnr.predict([[2.5]]))
```


### å®Œæ•´ç¤ºä¾‹

```python
from sklearn.datasets import load_iris
iris = load_iris()
X = iris.data[:, :4]
y = iris.target
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20)
from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()

scaler.fit(X_train)
X_train = scaler.transform(X_train)
X_test = scaler.transform(X_test)

import numpy as np
from sklearn.neighbors import KNeighborsRegressor
knnr = KNeighborsRegressor(n_neighbors=8)
knnr.fit(X_train, y_train)

print("The MSE is:",format(np.power(y-knnr.predict(X),4).mean()))

X = [[0], [1], [2], [3]]
y = [0, 0, 1, 1]
from sklearn.neighbors import KNeighborsRegressor
knnr = KNeighborsRegressor(n_neighbors=3)
knnr.fit(X, y)
print(knnr.predict([[2.5]]))
```

## RadiusNeighborsRegressor

æ­¤å›å½’å™¨åç§°ä¸­çš„åŠå¾„è¡¨ç¤ºæŒ‡å®šåŠå¾„rå†…æœ€è¿‘çš„é‚»å±…ï¼Œå…¶ä¸­ræ˜¯ç”¨æˆ·æŒ‡å®šçš„æµ®ç‚¹å€¼ã€‚å› æ­¤ï¼Œé¡¾åæ€ä¹‰ï¼Œè¯¥å›å½’å™¨åŸºäºæ¯ä¸ªè®­ç»ƒç‚¹çš„å›ºå®šåŠå¾„rå†…çš„é‚»å±…æ•°å®ç°å­¦ä¹ ã€‚è®©æˆ‘ä»¬åœ¨ä¸€ä¸ªå®ç°ç¤ºä¾‹çš„å¸®åŠ©ä¸‹æ›´åŠ äº†è§£å®ƒ-

### å®æ–½å®ä¾‹

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šå¯¹æ•°æ®å®æ–½KNNé›†ä½¿ç”¨scikitå­¦ä¹ å‘½åçš„é¸¢å°¾èŠ±æ•°æ®é›†**RadiusNeighborsRegressor** -

é¦–å…ˆï¼ŒæŒ‰ä»¥ä¸‹æ–¹å¼å¯¼å…¥IRISæ•°æ®é›†-

```python
from sklearn.datasets import load_iris
iris = load_iris()
```

ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦å°†æ•°æ®åˆ†ä¸ºè®­ç»ƒå’Œæµ‹è¯•æ•°æ®ã€‚æˆ‘ä»¬å°†ä½¿ç”¨Sklearn train_test_splitå‡½æ•°å°†æ•°æ®åˆ†æˆ70ï¼ˆè®­ç»ƒæ•°æ®ï¼‰å’Œ20ï¼ˆæµ‹è¯•æ•°æ®ï¼‰çš„æ¯”ç‡-

```python
X = iris.data[:, :4]
y = iris.target
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20)
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åœ¨Sklearné¢„å¤„ç†æ¨¡å—çš„å¸®åŠ©ä¸‹è¿›è¡Œæ•°æ®ç¼©æ”¾-

```python
from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
scaler.fit(X_train)
X_train = scaler.transform(X_train)
X_test = scaler.transform(X_test)
```

æ¥ä¸‹æ¥ï¼Œä»Sklearn å¯¼å…¥**RadiusneighborsRegressor**ç±»ï¼Œå¹¶æä¾›radiusçš„å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```python
import numpy as np
from sklearn.neighbors import RadiusNeighborsRegressor
knnr_r = RadiusNeighborsRegressor(radius=1)
knnr_r.fit(X_train, y_train)
```

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°MSEï¼ˆå‡æ–¹è¯¯å·®ï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```python
print("The MSE is:",format(np.power(y-knnr_r.predict(X),4).mean()))
```

ç°åœ¨ï¼Œä½¿ç”¨å®ƒæ¥é¢„æµ‹å€¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```python
X = [[0], [1], [2], [3]]
y = [0, 0, 1, 1]
from sklearn.neighbors import RadiusNeighborsRegressor
knnr_r = RadiusNeighborsRegressor(radius=1)
knnr_r.fit(X, y)
print(knnr_r.predict([[2.5]]))
```


### å®Œæ•´çš„å·¥ä½œ/å¯æ‰§è¡Œç¨‹åº

```python
from sklearn.datasets import load_iris

iris = load_iris()

X = iris.data[:, :4]
y = iris.target
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.20)
from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
scaler.fit(X_train)
X_train = scaler.transform(X_train)
X_test = scaler.transform(X_test)
import numpy as np
from sklearn.neighbors import RadiusNeighborsRegressor
knnr_r = RadiusNeighborsRegressor(radius = 1)
knnr_r.fit(X_train, y_train)
print("The MSE is:",format(np.power(y-knnr_r.predict(X),4).mean()))
X = [[0], [1], [2], [3]]
y = [0, 0, 1, 1]
from sklearn.neighbors import RadiusNeighborsRegressor
knnr_r = RadiusNeighborsRegressor(radius = 1)
knnr_r.fit(X, y)
print(knnr_r.predict([[2.5]]))
```